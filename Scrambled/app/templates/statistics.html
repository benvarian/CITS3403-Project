{% extends "base.html" %} {% block content %}

<div class="row gx-0">
  <div class="col-sm-2"></div>
  <div class="col-sm-8" style="text-align: center">
    <table class="table">
      <tr>
        <td>      
          {% if user == current_user %}
          <h1>Hi {{ user.username }}!</h1>
          <p><a href="/logout">logout</a></p>
          {% else %}
          <h1>Profile for: {{ user.username }}</h1>
          {% endif %}
          {% if user.about_me %}<p>About you: {{ user.about_me }}</p>{% endif %}
          <p>{{ user.followers.count() }} followers, {{ user.followed.count() }} following.</p>
          {% if user == current_user %}
          <p><a href="{{ url_for('edit_profile') }}">Edit your profile</a></p>
          {% elif not current_user.is_following(user) %}
          <p>
              <form action="{{ url_for('follow', username=user.username) }}" method="post">
                  {{ form.hidden_tag() }}
                  {{ form.submit(value='Follow', class_='btn btn-primary') }}
              </form>
          </p>
          {% else %}
          <p>
              <form action="{{ url_for('unfollow', username=user.username) }}" method="post">
                  {{ form.hidden_tag() }}
                  {{ form.submit(value='Unfollow',class_='btn btn-primary') }}
              </form>
          </p>
          {% endif %}
      </td>
    </tr>
    </table>
    <h6>Games of Normal Scrambled Played: {{ gamesPlayedNormal }} </h6>
    <h6>Games of Speed Scrambled Played: {{ gamesPlayedSpeed }} </h6>
    <h6>Average Score for Normal Mode: {{ avgNormalScore }} </h6>
    <h6>Average Score for Speed Mode: {{ speedModeAverage }} </h6>
    <p><a href="{{ url_for('leaderboard') }}">Leaderboard</a></p>
    <canvas id="myChart" width="200" height="200"></canvas>
  </div>
  <div class="col-sm-2"></div>
</div>

<script>
  let scoreofgameNormal = JSON.parse({{ datesScore | tojson }});
  let scoreofgameSpeed = JSON.parse({{ speedScores | tojson }});
  let dates = JSON.parse({{ datesofSubmissions | tojson }});
  let average = JSON.parse({{ averagegameScore | tojson }});


  const ctx = document.getElementById("myChart").getContext("2d");
  const myChart = new Chart(ctx, {
    type: "line",
    data: {
      labels: dates,
      datasets: [
        {
          label: "Normal Mode",
          data: scoreofgameNormal,
          backgroundColor: '#3380ff',
          borderColor:'#3380ff',
          borderWidth: 2,
          tension: 0,

        },
        {label: 'Speed Mode',
          data: scoreofgameSpeed,
          backgroundColor: '#da0037',
          borderColor: '#da0037',
          borderWidth: 2,
          tension: 0
        },
      ],
    },
    options: {
      scales: {
        x: {
          beginAtZero: true
        },
        y: {
          suggestedMin: 250
        },
      },
    },
  });
</script>

{% endblock %}

